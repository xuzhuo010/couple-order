<!DOCTYPE html>
<html>
<head>
    <title>ğŸ‘¨ğŸ³ æƒ…ä¾£ç‚¹é¤ - å¨å¸ˆç«¯</title>
    <style>
        /* ä¸é¡¾å®¢ç«¯ç›¸ä¼¼çš„æ ·å¼ */
        .order { background: #fff3f3; padding: 15px; margin: 10px; }
    </style>
</head>
<body>
    <h1>ğŸ‘¨ğŸ³ ä¸“å±å¤§å¨æ¨¡å¼</h1>
    <input type="text" id="roomId" class="room-id" placeholder="è¾“å…¥æˆ¿é—´å·">
    <button onclick="startListening()">å¼€å§‹ç›‘å¬è®¢å• ğŸ””</button>
    <div id="orders"></div>

    <script type="module">
        // å¯¼å…¥æ¨¡å—
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.8/firebase-app.js";
        import { 
          getDatabase,
          ref,
          onChildAdded,
          update,
          serverTimestamp
        } from "https://www.gstatic.com/firebasejs/9.6.8/firebase-database.js";
      
        // å¯¼å…¥é…ç½®
        import { firebaseConfig } from './firebase-config.js';
      
        // åˆå§‹åŒ–
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
      
        function startListening() {
          const roomId = document.getElementById('roomId').value;
          const ordersRef = ref(db, `rooms/${roomId}/orders`);
      
          // å®æ—¶ç›‘å¬æ–°è®¢å•
          onChildAdded(ordersRef, (snapshot) => {
            const order = snapshot.val();
            if (order.status === 'pending') {
              showOrder(snapshot.key, order);
            }
          });
        }
      
        function showOrder(key, order) {
  const ordersDiv = document.getElementById('orders');
  const orderEl = document.createElement('div');
  orderEl.className = 'order';
  
  // ä½¿ç”¨äº‹ä»¶ç›‘å¬å™¨ç»‘å®šæŒ‰é’®
  const button = document.createElement('button');
  button.textContent = 'å®Œæˆçƒ¹é¥ª âœ…';
  button.addEventListener('click', () => completeOrder(key));

  orderEl.innerHTML = `
    <h3>ğŸ“¦ æ–°è®¢å• ${new Date(order.timestamp).toLocaleTimeString()}</h3>
    <p>${order.foods.join(', ')}</p>
  `;
  orderEl.appendChild(button);
  ordersDiv.appendChild(orderEl);
}
      </script>
</body>
</html>
